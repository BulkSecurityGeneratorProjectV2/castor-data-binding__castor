<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2016-05-15 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160515" />
    <meta http-equiv="Content-Language" content="en" />
    <title>castor &#x2013; Best practice</title>
    <link rel="stylesheet" href="../../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../../css/site.css" />
    <link rel="stylesheet" href="../../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/castor-data-binding/castor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://castor.org/" id="bannerLeft">
                <h2>Castor</h2>
                </a>
                      </div>
        <div class="pull-right">              <div id="bannerRight">
                                                                                                <img src="../../../images/castor.gif" />
                </div>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="http://castor-data-binding.github.io/castor/" class="externalLink" title="Castor data binding">
        Castor data binding</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../../.././" title="castor">
        castor</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Best practice</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2016-05-15</li>
              <li id="projectVersion" class="pull-right">
                      <span class="divider">|</span>
                    Version: 1.4.1
        </li>
            
                                    
    <li class="pull-right">
        <span class="divider">|</span>
                      <a href="http://github.com/" class="externalLink" title="Github">
        Github</a>
      </li>

  
    <li class="pull-right">
                      <a href="http://maven.apache.org/" class="externalLink" title="Maven">
        Maven</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                              
      <li>
  
                          <a href="../../../main/index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../../../main/features.html" title="Features">
          <span class="none"></span>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../../../main/download.html" title="Binary distributions">
          <span class="none"></span>
        Binary distributions</a>
            </li>
                
      <li>
  
                          <a href="../../../github-report.html" title="Recent changes">
          <span class="none"></span>
        Recent changes</a>
            </li>
                
      <li>
  
                          <a href="../../../main/maven-archetypes.html" title="Maven archetypes">
          <span class="none"></span>
        Maven archetypes</a>
            </li>
                
      <li>
  
                                        <a href="../../../rss/castor-announce.xml" target="_blank" title="RSS">RSS                                               <img class="imageLink" src="../../../images/rss.svg" alt="" width="16" height="16"/>
  </a>
                      </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../../../reference-guide/index.html" title="Reference guide">
          <span class="none"></span>
        Reference guide</a>
            </li>
                
      <li>
  
                          <a href="../../../documentation/reference.guide.html" title="Reference guide (older versions)">
          <span class="none"></span>
        Reference guide (older versions)</a>
            </li>
                
      <li>
  
                          <a href="../../../documentation/publications.html" title="Publications">
          <span class="none"></span>
        Publications</a>
            </li>
                
      <li>
  
                          <a href="../../../../wiki" title="Project Wiki">
          <span class="none"></span>
        Project Wiki</a>
            </li>
                              <li class="nav-header">Development/Support</li>
                              
      <li>
  
                          <a href="../../../support/mailing-lists.html" title="Mailing lists">
          <span class="none"></span>
        Mailing lists</a>
            </li>
                
      <li>
  
                          <a href="../../../support/contributing.html" title="Contributing">
          <span class="none"></span>
        Contributing</a>
            </li>
                
      <li>
  
                          <a href="../../../support/contributors.html" title="Contributors">
          <span class="none"></span>
        Contributors</a>
            </li>
                
      <li>
  
                          <a href="../../../support/support.html" title="Support">
          <span class="none"></span>
        Support</a>
            </li>
                
      <li>
  
                          <a href="../../../support/professional-services.html" title="Professional services">
          <span class="none"></span>
        Professional services</a>
            </li>
                              <li class="nav-header">Tools</li>
                              
      <li>
  
                          <a href="../../../tools/schema-generator.html" title="Schema generator">
          <span class="none"></span>
        Schema generator</a>
            </li>
                              <li class="nav-header">More</li>
                              
      <li>
  
                          <a href="../../../more/examples.html" title="Examples">
          <span class="none"></span>
        Examples</a>
            </li>
                              <li class="nav-header">About</li>
                              
      <li>
  
                          <a href="../../../about/licenses.html" title="License">
          <span class="none"></span>
        License</a>
            </li>
                
      <li>
  
                          <a href="../../../about/references.html" title="References">
          <span class="none"></span>
        References</a>
            </li>
                
      <li>
  
                          <a href="../../../about/project-name.html" title="Project name">
          <span class="none"></span>
        Project name</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                    
      <li>
  
                          <a href="../../../project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="http://castor-data-binding.github.io/castor/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://travis-ci.org/castor-data-binding/castor" title="Travis-CI Build status (master branch)" class="builtBy">
        <img class="builtBy"  alt="Travis-CI Build status (master branch)" src="https://travis-ci.org/castor-data-binding/castor.svg?branch=master"    />
      </a>
                                                                                                    <a href="https://maven-badges.herokuapp.com/maven-central/org.codehaus.castor/castor/" title="Maven Central" class="builtBy">
        <img class="builtBy"  alt="Maven Central" src="https://maven-badges.herokuapp.com/maven-central/org.codehaus.castor/castor/badge.svg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Best practice</h1>
<p>There are many users of Castor XML who (want to) use Castor XML in in high-volume applications. To fine-tune Castor for such an environment, it is necessary to understand many of the product features in detail and to be able to balance their use according to the application needs. Even though many of these features are documented in various places, people frequently asked for a &#x2018;best practices&#x2019; document, a document that brings together these technical topics in one place and that presents them as a set of easy-to-use recipes.</p>
<p>Please be aware that this document is <i>under construction</i>. But still we believe that this document &#x2013; even when in its conception phase &#x2013; provides valuable information to users of Castor XML.</p>
<div class="section">
<h2><a name="General"></a>General</h2>
<div class="section">
<h3><a name="Source_Generator"></a>Source Generator</h3>
<p>It is not generally recommended to generate code into the default package, especially since code in the default package cannot be referenced from code in any other package.</p>
<p>Additionally, we recommend that generated code go into a different package then the code that makes use of the generated code. For example, if your application uses Castor to process an XML configuration file that is used by code in the package <tt>org.example.userdialog</tt> then we do not recommend that the generated code also go into that package. However, it would be reasonable to generate source to process this XML configuration file into the package <tt>org.example.userdialog.xmlconfig</tt>.</p></div></div>
<div class="section">
<h2><a name="Performance_Considerations"></a>Performance Considerations</h2>
<div class="section">
<h3><a name="General"></a>General</h3>
<p>Creating instances of <tt>org.exolab.castor.xml.Marshaller</tt> and <tt>org.exolab.castor.xml.Unmarshaller</tt> for the purpose of XML data binding is easy to achieve at the API usage level. However, details of API use have an impact on application performance; each instance creation involves setup operations.</p>
<p>This is generally not an issue for one-off invocations; however, in a multi-threaded, high volume use scenario this can be become a serious issue. Internally, Castor uses a collection of <i>Descriptor</i> classes to keep information about the Java entities to be marshaled and unmarshaled. With each instance creation of (Un)Marshaller, this collection will be built from scratch (again and again).</p>
<p>To avoid this initial configuration &#x2018;penalty&#x2019;, Castor allows you to cache these Descriptor classes through its <tt>org.exolab.castor.xml.ClassDescriptorResolver</tt> component. This cache allows reuse of these Descriptor instances between (Un)Marshaller invocations.</p></div>
<div class="section">
<h3><a name="Use_of_XMLContext_-_With_and_without_a_mapping_file"></a>Use of XMLContext - With and without a mapping file</h3>
<p>With the introduction of the new <tt>org.exolab.castor.xml.XMLContext</tt> class, the use of a <tt>ClassDescriptorResolver</tt> has been greatly simplified in that such an instance is managed by the XMLContext per default. As such, there&#x2019;s no need to pass a <tt>ClassDescriptorResolver</tt> instance to <tt>Marshaller</tt>/ <tt>Unmarshaller</tt> instances anymore, as this is done automatically when such instances are created through</p>

<ul>
  
<li>
<p><tt>org.exolab.castor.xml.XMLContext.createMarshaller()</tt></p></li>
  
<li>
<p><tt>org.exolab.castor.xml.XMLContext.createUnmarshaller()</tt></p></li>
</ul>
<p>For example, to create a <tt>Marshaller</tt> instance that is pre-configured with an instance of <tt>ClassDescriptorResolver</tt>, use the following code fragment:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Mapping mapping = new Mapping();
mapping.loadMapping(new InputSource(...));
        
XMLContext context = new XMLContext();
context.addMapping(mapping);

Marshaller marshaller = context.createMarshaller();
</pre></div></div>
<p>In the case where no mapping file is used, it is still possible to instruct the <tt>org.exolab.castor.xml.XMLContext</tt> to <i>pre-load</i> class descriptors for a given package via the methods enlisted below.</p>
<p>As above, create an instance of <tt>org.exolab.castor.xml.XMLContext</tt> and configure it according to your needs as shown below:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">XMLContext context = new XMLContext();
context.addPackage(&quot;your.package.name&quot;);

Marshaller marshaller = context.createMarshaller();
</pre></div></div>
<p>The <tt>org.exolab.castor.xml.XMLContext</tt> class provides for various methods to load class descriptors for individual classes and/or packages.</p>

<table border="0" class="table table-striped"><caption>Methods on XMLContext to create Un-/Marshaller objects</caption>
  <thead>
    
<tr class="a">
      
<th>Method </th>
      
<th>Description </th>
      
<th><tt>.castor.cdr</tt></th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>addClass(Class) on <tt>org.exolab.castor.xml.XMLContext</tt> </td>
      
<td>Loads the class descriptor for one class. </td>
      
<td>n/a</td>
    </tr>
    
<tr class="a">
      
<td>addClass(Class[]) on <tt>org.exolab.castor.xml.XMLContext</tt> </td>
      
<td>Loads the class descriptors for a collection of classes. </td>
      
<td>n/a</td>
    </tr>
    
<tr class="b">
      
<td>addPackage(String) on <tt>org.exolab.castor.xml.XMLContext</tt> </td>
      
<td>Loads the class descriptor for all classes in the defined package. </td>
      
<td>Required</td>
    </tr>
    
<tr class="a">
      
<td>addPackages(String[]) on <tt>org.exolab.castor.xml.XMLContext</tt> </td>
      
<td>Loads the class descriptor for all classes in the defined packages. </td>
      
<td>Required</td>
    </tr>
  </tbody>
  
</table>

<blockquote>
<p><b>Note</b></p>
<p>For some of the methods, pre-loading class descriptords will only work if you provide the <tt>.castor.cdr</tt> file with your generated classes (as generated by the XML code generator). If no such file is shipped, Castor will not be able to pre-load the descriptors, and will fall back to its default descriptor loading mechanism.</p>
</blockquote></div>
<div class="section">
<h3><a name="Use_of_MarshallerUnmarshaller"></a>Use of Marshaller/Unmarshaller</h3>
<div class="section">
<h4><a name="Use_of_ClassDescriptorResolver"></a>Use of ClassDescriptorResolver</h4>
<p>When you do not use the <tt>XMLContext</tt> class, you will have to manually manage your <tt>org.exolab.castor.xml.XMLClassDescriptorResolver</tt>. To do so, first create an instance of <tt>org.exolab.castor.xml.XMLClassDescriptorResolver</tt> using the following code fragment:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">XMLClassDescriptorResolver classDescriptorResolver = 
   (XMLClassDescriptorResolver) ClassDescriptorResolverFactory.createClassDescriptorResolver(BindingType.XML);
MappingUnmarshaller mappingUnmarshaller = new MappingUnmarshaller();
MappingLoader mappingLoader = 
   mappingUnmarshaller.getMappingLoader(mapping, BindingType.XML);
classDescriptorResolver.setMappingLoader(mappingLoader);
</pre></div></div>
<p>and then reuse this instance as shown below:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">   Unmarshaller unmarshaller = new Unmarshaller();
   unmarshaller.setResolver(classDescriptorResolver);
   unmarshaller.unmarshal(...);
</pre></div></div></div>
<div class="section">
<h4><a name="Use_of_ClassDescriptorResolver_for_pre-loading_compiled_descriptors"></a>Use of ClassDescriptorResolver for pre-loading compiled descriptors</h4>
<p>When you are not using a mapping file, but you have generated Java classes and their corresponding descriptor classes using the Castor XML code generator, you might want to instruct the <tt>org.exolab.castor.xml.XMLClassDescriptorResolver</tt> to <i>pre-load</i> class descriptors (as enumerated explicitly or for a given package) using various <tt>add*</tt> methods.</p>
<p>As above, create an instance of <tt>org.exolab.castor.xml.XMLClassDescriptorResolver&quot;&gt;XMLClassDescriptorResolver</tt> using the following code fragment:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">   XMLClassDescriptorResolver classDescriptorResolver = (XMlClassDescriptorResolver)
      ClassDescriptorResolverFactory.createClassDescriptorResolver(BindingType.XML);
   classDescriptorResolver.setClassLoader(...);
   classDescriptorResolver.addClass(&quot;your.package.name.A&quot;);
   classDescriptorResolver.addClass(&quot;your.package.name.B&quot;);
   classDescriptorResolver.addClass(&quot;your.package.name.C&quot;);
           
</pre></div></div>
<p>and then reuse this instance as shown above. Alternatively, add complete packages to the resolver configuration as follows:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">   XMLClassDescriptorResolver classDescriptorResolver = (XMlClassDescriptorResolver)
      ClassDescriptorResolverFactory.createClassDescriptorResolver(BindingType.XML);
   classDescriptorResolver.setClassLoader(...);
   classDescriptorResolver.addPackage(&quot;your.package.name&quot;);
           
</pre></div></div>
<p>The <tt>org.exolab.castor.xml.XMLClassDescriptorResolver</tt> interface provides various other methods to load class descriptors for individual classes and/or packages.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>Method </th>
      
<th>Description </th>
      
<th>Requires <tt>.castor.cdr</tt></th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>addClass(String) </td>
      
<td>Loads the class descriptor for one class. </td>
      
<td>No</td>
    </tr>
    
<tr class="a">
      
<td>addClass(String[]) </td>
      
<td>Loads the class descriptors for a collection of classes. </td>
      
<td>No</td>
    </tr>
    
<tr class="b">
      
<td>addPackage(String) </td>
      
<td>Loads the class descriptors for all classes in the package defined. </td>
      
<td>Yes</td>
    </tr>
    
<tr class="a">
      
<td>addPackages(String[]) </td>
      
<td>Loads the class descriptors for all classes in the package defined. </td>
      
<td>Yes</td>
    </tr>
  </tbody>
</table>

<blockquote>
<p><b>Note</b></p>
<p>For some of the methods, pre-loading class descriptords will only work if you provide the <tt>.castor.cdr</tt> file with your generated classes (as generated by the XML code generator). If no such file is shipped, Castor will not be able to pre-load the descriptors, and will fall back to its default descriptor loading mechanism.</p>
</blockquote></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2016.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
